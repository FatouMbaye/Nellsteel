(window.webpackJsonp=window.webpackJsonp||[]).push([["telemetry"],{C4R5:function(e,t,o){"use strict";o.d(t,"a",(function(){return w}));var i,n=o("D57K"),a=o("ypwz"),c=o("dTwT"),s=o("y+Kz"),r=o("rvYQ"),d=o("HS3Q"),l=o("9J8d"),p=o("FaCY"),u=o("s9+9"),h=o("Z3LZ");!function(e){e.NavigationData="NavigationDataAdapter",e.TopicsData="TopicsDataAdapter"}(i||(i={}));class m{constructor(e,t){this.onUpdateFollowedTopics=()=>{if(!this.connector)return this.onRouteUpdateCallback([]);const e=this.connector.getCurrentState(),t=e.followedTopicIds,o=e.topicMap,n=[];t&&o&&t.forEach(e=>{const t=o[e],a={path:Object(d.d)(t.name||t.canonicalName,e),display:t.name,experienceInfo:this.dynamicRouteExperienceInfo,context:{feedId:e},pivotId:e,dynamicPivotSource:i.TopicsData};n.push(a)}),this.onRouteUpdateCallback(n)},this.onRouteUpdateCallback=e,this.dynamicRouteExperienceInfo=t}getDynamicPivotsFromDataConnector(e){return Object(n.b)(this,void 0,void 0,(function*(){switch(e){case u.a.TopicData:yield this.getPivotsFromTopicData();break;case u.a.NavigationData:yield this.getPivotsFromNavigationData();break;default:return}}))}getPivotsFromTopicData(){return Object(n.b)(this,void 0,void 0,(function*(){yield Object(h.l)(),l.a.getInstance().rootReducer.getDataConnector(u.a.TopicData).then(e=>{this.connector=e,this.connector.getFollowedTopics(!1).then(()=>{this.onUpdateFollowedTopics()})}),p.a.followedTopics.registerObserver(this.onUpdateFollowedTopics),p.a.updateTopicFollowedState.registerObserver(this.onUpdateFollowedTopics)}))}getPivotsFromNavigationData(){return Object(n.b)(this,void 0,void 0,(function*(){if(this.connector=yield l.a.getInstance().rootReducer.getDataConnector(u.a.NavigationData),this.connector){const e=yield this.connector.getNavigationItems(r.b.HostPage.verticalKey,r.b.HostPage.categoryKey);this.onRouteUpdateCallback(this.mapNavigationItemsToDynamicRoutes(e))}else this.onRouteUpdateCallback([])}))}mapNavigationItemsToDynamicRoutes(e){return e.map(e=>({path:e.targetUrl,externalUrl:e.targetUrl,display:e.displayText,pivotId:e.categoryKey,dynamicPivotSource:i.NavigationData}))}}var y,f=o("b2pY");class g{constructor(e){this.staticRoutes=[],this.dynamicRoutes=[],this.onUpdateRoutesCallbacks=[],this.switchListeners=[],this.callSwitchListeners=e=>{if(!this.switchListeners.length)return;const t=this.getPivotSelectionInfoFromPath(e.state&&e.state.previousPath),o=this.getPivotSelectionInfoFromPath(e.pathname,e),i={newSelection:o,oldSelection:t};this.config.enableRememberedPivots&&Object(c.a)().setItem(s.d,o&&o.pivotId),this.switchListeners.sort((e,t)=>e.order-t.order);for(const e of this.switchListeners)e.callback(i)},e&&(Object(d.e)(e.enableLocaleFeedPrefix),this.setRoutes(e)),f.a.listen(this.callSwitchListeners)}setRoutes(e){this.config=e,this.setStaticRoutes(),this.config.disableLoadingDynamicRoutes||this.setDynamicRoutes()}pushHistory(e,t,o,i){const n=f.a.location.pathname;f.a.push(Object(d.d)(e,t),{previousPath:n,context:o},i)}getStaticRoutes(){return this.staticRoutes}getDynamicRoutes(){return this.dynamicRoutes}getDynamicRoute(){const e=f.a.location.pathname.split("/"),t=e.findIndex(e=>"interest"===e.toLowerCase()),o=t>-1&&t<e.length-1?e[t+1]:"";return{path:Object(d.d)("interest"),experienceInfo:this.config.dynamicRouteExperienceInfo,pivotId:"oneriver.xfeed",display:decodeURIComponent(o)}}isDynamicRoute(e){let t="";return d.c&&(t=r.b.AppType===a.a.Windows?"/"+r.b.CurrentMarket+"/feed":"/"+r.b.CurrentMarket),t+="/interest",0===e.indexOf(t)}getCurrentRoute(){const e=f.a.location.pathname,t=this.staticRoutes.find(t=>t.path===e);return t||(e.includes("/interest")?this.getDynamicRoute():null)}addDynamicRouteListener(e){this.onUpdateRoutesCallbacks.push(e)}addSwitchListener(e,t=y.AfterLoadContent){this.switchListeners.push({callback:e,order:t})}getRememberedPivot(){if(!this.config.enableRememberedPivots)return;const e=Object(c.a)().getItem(s.d);e&&this.config.staticRoutes.forEach(t=>{t.pivotId===e&&this.pushHistory(t.canonicalName)})}getPivotSelectionInfoFromPath(e,t){if(!e)return null;const o=this.config.staticRoutes.find(t=>Object(d.d)(t.canonicalName)===e);if(o)return{pivotId:o.pivotId,telemetryPageName:o.telemetryPageName,telemetryPivotCategory:o.telemetryPivotCategory,display:o.canonicalName};if(!this.isDynamicRoute(e))return null;const i=e.split("/");let n=0;d.c&&(n=r.b.AppType===a.a.Windows?2:1);const c=t&&t.state&&t.state.context;return{telemetryPageName:"xfeed",telemetryPivotCategory:"news",pivotId:c&&t.state.context.feedId||i.length>=4+n&&i[3+n],display:c&&(t.state.context.display||t.state.context.query)||i.length>=3+n&&decodeURIComponent(i[2+n])}}setStaticRoutes(){const{staticRoutes:e}=this.config;e.forEach(e=>{const t={path:Object(d.d)(e.canonicalName)||e.externalUrl,externalUrl:e.externalUrl,experienceInfo:e.experienceInfo,queryParamOverrides:e.queryParamOverrides,display:e.display||e.canonicalName,pivotId:e.pivotId,context:e.context};this.staticRoutes.push(t)})}setDynamicRoutes(){return Object(n.b)(this,void 0,void 0,(function*(){const e=new m(this.onUpdateDynamicRoute.bind(this),this.config.dynamicRouteExperienceInfo);yield e.getDynamicPivotsFromDataConnector(this.config.dynamicRouteDataConnector)}))}onUpdateDynamicRoute(e){this.dynamicRoutes=e;for(const e of this.onUpdateRoutesCallbacks)e(this.dynamicRoutes)}}let v;!function(e){e[e.Telemetry=0]="Telemetry",e[e.Monetization=1]="Monetization",e[e.LoadContent=2]="LoadContent",e[e.AfterLoadContent=3]="AfterLoadContent"}(y||(y={}));const w=e=>v?(e&&v.setRoutes(e),v):(v=new g(e),v)},FaCY:function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));var i=o("G82u");class n{}n.followedTopics=new i.a("FollowedTopics"),n.followedTopicsFailed=new i.a("FollowedTopicsFailedSignature"),n.recommendedTopics=new i.a("RecommendedTopics"),n.recommendedTopicsFailed=new i.a("RecommendedTopicsFailed"),n.topic=new i.a("Topic"),n.topicFailed=new i.a("TopicsFailed"),n.topics=new i.a("Topics"),n.topicsFailed=new i.a("TopicsFailed"),n.topicGroup=new i.a("TopicGroup"),n.topicGroupFailed=new i.a("TopicGroupFailed"),n.updateTopicFollowedState=new i.a("UpdateTopicFollowedState"),n.updateTopicFollowedStateFailed=new i.a("UpdateTopicFollowedStateFailed")},HS3Q:function(e,t,o){"use strict";o.d(t,"c",(function(){return a})),o.d(t,"e",(function(){return c})),o.d(t,"d",(function(){return s})),o.d(t,"f",(function(){return r})),o.d(t,"b",(function(){return d})),o.d(t,"a",(function(){return l}));var i=o("rvYQ"),n=o("ypwz");let a=!1;function c(e){a=e}function s(e,t,o=!0){if(a&&o){let o="/"+i.b.CurrentMarket;if(i.b.AppType===n.a.Windows&&(o+="/feed"),!e)return o;if(t)return o+`/interest/${encodeURIComponent(e)}/${encodeURIComponent(t)}`;const a="/"===e[0]?e.slice(1):e;return o+(l[a]?""+l[a]:"/"+a)}{if(!e)return"";if(t)return`/interest/${encodeURIComponent(e)}/${encodeURIComponent(t)}`;const o="/"===e[0]?e.slice(1):e;return l[o]||"/"+o}}function r(e){return!!(e&&e.oldSelection&&e.newSelection)&&(!(!e.oldSelection||!e.oldSelection.pivotId)&&!(!e.newSelection||!e.newSelection.pivotId))}var d;!function(e){e.MyFeed="myFeed",e.Personalize="personalize",e.Saves="saves"}(d||(d={}));const l={myFeed:"/",personalize:"/personalize",interest:"/interest/*/:id",saves:"/personalize/saves"}},YS0M:function(e,t,o){"use strict";o.r(t),o.d(t,"TelemetryDataConnector",(function(){return u})),o.d(t,"TelemetryDataReducer",(function(){return h})),o.d(t,"ToolingInfo",(function(){return m}));var i=o("1w6q"),n=o("9J8d"),a=o("u5KZ"),c=o("w0HK"),s=o("loKy"),r=o("s9+9");const d="tp";var l=o("HDSB"),p=o("C4R5");class u extends i.a{constructor(e,t,o,i,d,u,h){super(e,t,o,i,d,u,h);const m=Object(c.a)(),y=m.getSelectedPivot();if(y&&y.telemetryPivotCategory){let e;e.page.pivot=y.telemetryPivotCategory,a.a.updatePageMetadata(e)}if(Object(l.a)()){const e=n.a.getInstance().rootReducer.connector(r.a.SharedState);e&&e.getCurrentState().useHistory?Object(p.a)().addSwitchListener(this.onPivotSwitch,s.a.Telemetry):m.addSwitchListener(this.onPivotSwitch,s.a.Telemetry)}}onPivotSwitch(e){let t;const o=e.newSelection;if(o&&(a.a.addOrUpdateCustomProperty(d,o.display),t={feed:{id:o.pivotId,name:o.display,type:"xfeed"===o.telemetryPageName?"category filter":void 0},page:{content:{topic:o.display},pivot:""}},o.telemetryPivotCategory&&(t.page.pivot=o.telemetryPivotCategory),a.a.updatePageMetadata(t)),e.oldSelection)return o.telemetryPageName&&(t.page.name=o.telemetryPageName),a.a.updatePageMetadata(t),void a.a.sendPageView(null,!1)}}class h{reduce(e,t){return{}}}const m={experienceConfigSchema:{}}}}]);